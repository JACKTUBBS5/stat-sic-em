/* Chapter 12 */

data bprs;
  infile cards expandtabs missover;
  input id x0-x8;
  group=1;
  if _n_>20 then group=2;
  id=100*group+id;
cards;
    1   42  36  36  43  41  40  38  47  51
    2   58  68  61  55  43  34  28  28  28
    3   54  55  41  38  43  28  29  25  24
    4   55  77  49  54  56  50  47  42  46
    5   72  75  72  65  50  39  32  38  32
    6   48  43  41  38  36  29  33  27  25
    7   71  61  47  30  27  40  30  31  31
    8   30  36  38  38  31  26  26  25  24
    9   41  43  39  35  28  22  20  23  21
    10  57  51  51  55  53  43  43  39  32
    11  30  34  34  41  36  36  38  36  36
    12  55  52  49  54  48  43  37  36  31
    13  36  32  36  31  25  25  21  19  22
    14  38  35  36  34  25  27  25  26  26
    15  66  68  65  49  36  32  27  30  37
    16  41  35  45  42  31  31  29  26  30
    17  45  38  46  38  40  33  27  31  27
    18  39  35  27  25  29  28  21  25  20
    19  24  28  31  28  29  21  22  23  22
    20  38  34  27  25  25  27  21  19  21
    1   52  73  42  41  39  38  43  62  50
    2   30  23  32  24  20  20  19  18  20
    3   65  31  33  28  22  25  24  31  32
    4   37  31  27  31  31  26  24  26  23
    5   59  67  58  61  49  38  37  36  35
    6   30  33  37  33  28  26  27  23  21
    7   69  52  41  33  34  37  37  38  35
    8   62  54  49  39  55  51  55  59  66
    9   38  40  38  27  31  24  22  21  21
    10  65  44  31  34  39  34  41  42  39
    11  78  95  75  76  66  64  64  60  75
    12  38  41  36  27  29  27  21  22  23
    13  63  65  60  53  52  32  37  52  28
    14  40  37  31  38  35  30  33  30  27
    15  40  36  55  55  42  30  26  30  37
    16  54  45  35  27  25  22  22  22  22
    17  33  41  30  32  46  43  43  43  43
    18  28  30  29  33  30  26  36  33  30
    19  52  43  26  27  24  32  21  21  21
    20  47  36  32  29  25  23  23  23  23
;

data bprsl;
  set bprs;
  array xs {*} x0-x8;
  do week=0 to 8;
    bprs=xs{week+1};
    output;
  end;
  keep id group week bprs;
run;

proc print data=bprsl(obs=45) noobs;
run;

proc sgpanel data=bprsl ;
  panelby group / spacing=10;
  series y=bprs x=week /group=id ;
run;

proc sort data=bprsl;
 by week;
run;

proc stdize data=bprsl out=bprslz method=std;
  var bprs;
  by week;
run;

proc sgpanel data=bprslz ;
  panelby group / spacing=10;
  series y=bprs x=week /group=id ;
run;

proc sgplot data=bprsl;
  vline week / response=bprs stat=mean group=group limitstat=stderr groupdisplay=cluster;
  xaxis type=linear;
run;

proc sgplot data=bprsl;
  vbox bprs / category=week group=group nomean nocaps;
run;

data bprs;
 set bprs;
 mnbprs=mean(of x1-x8);
run;

proc sgplot data=bprs;
  vbox mnbprs / category=group ;
run;

proc ttest data=bprs;
  class group;
  var mnbprs;
run;

proc glm data=bprs;
  class group;
  model mnbprs=x0 group ;
run;

data labour;
  infile cards missover;
  input id x0-x6;
  group=1;
  if _n_>20 then group=2;
  mnpain=mean(of x0-x6);
cards;
    1   0.0 0.0 0.0 0.0         
    2   0.0 0.0 0.0 0.0 2.5 2.3 14.0
    3   38.0    5.0 1.0 1.0 0.0 5.0 
    4   6.0 48.0    85.0    0.0 0.0     
    5   19.0    5.0                 
    6   7.0 0.0 0.0 0.0         
    7   44.0    42.0    42.0    45.0            
    8   1.0 0.0 0.0 0.0 0.0 6.0 24.0
    9   24.5    35.0    13.0                
    10  1.0 30.5    81.5    67.5    98.5    97.0    
    11  35.5    44.5    55.0    69.0    72.5    39.5    26.0
    12  0.0 0.0 0.0 0.0 0.0 0.0 0.0
    13  8.0 30.5    26.0    24.0    29.0    45.0    91.0
    14  7.0 6.5 7.0 4.0 10.0        
    15  6.0 8.5 19.5    16.5    42.5    45.5    48.5
    16  32.5    9.5 7.5 5.5 4.5 0.0 7.0
    17  10.5    10.0    18.0    32.5    0.0 0.0 0.0
    18  11.5    20.5    32.5    37.0    39.0        
    19  72.0    91.5    4.5 32.0    10.5    10.5    10.5
    20  0.0 0.0 0.0 0.0 13.54   7.0 
    1   4.0 9.0 30.0    75.0    49.0    97.0    
    2   0.0 0.0 1.0 27.5    95.0    100.0   
    3   9.0 6.0 25.0                
    4   52.5    18.0    12.5                
    5   90.5    99.0    100.0   100.0   100.0   100.0   100.0
    6   74.0    70.0    81.5    94.5    97.0        
    7   0.0 0.0 0.0 1.5 0.0 18.0    71.0
    8   0.0 51.5    56.0                
    9   6.5 7.0 7.0 9.0 25.0    36.0    20.0
    10  19.0    31.0    41.0    58.0            
    11  6.0 23.0    45.0    67.0    90.5        
    12  42.0    64.0    6.0             
    13  86.5    53.0    88.0    100.0   100.0       
    14  50.0    100.0   100.0   100.0   100.0       
    15  27.5    36.5    74.0    97.0    100.0   100.0   95.0
    16  0.0 0.0 6.0 6.0         
    17  62.0    79.0    80.5    85.0    90.0    97.5    97.0
    18  17.5    27.5    21.0    60.0    80.0    97.0    
    19  6.5 5.5 18.5    20.0    36.5    63.5    81.5
    20  8.0 9.0 35.5    39.0    70.0    92.0    98.0
;

proc ttest data=labour;
  class group;
  var mnpain;
run;

data resptrial;
 input id centre treat sex age bl v1-v4;
 ngood=sum(of v1-v4);
 visits=4;
 mnstatus=mean(of v1-v4);
 arcsin=arsin(mnstatus);
 arcroot=arsin(sqrt(mnstatus));
cards;
1   1   1   1   46  0   0   0   0   0
2   1   1   1   28  0   0   0   0   0
3   1   2   1   23  1   1   1   1   1
4   1   1   1   44  1   1   1   1   0
5   1   1   2   13  1   1   1   1   1
6   1   2   1   34  0   0   0   0   0
7   1   1   1   43  0   1   0   1   1
8   1   2   1   28  0   0   0   0   0
9   1   2   1   31  1   1   1   1   1
10  1   1   1   37  1   0   1   1   0
11  1   2   1   30  1   1   1   1   1
12  1   2   1   14  0   1   1   1   0
13  1   1   1   23  1   1   0   0   0
14  1   1   1   30  0   0   0   0   0
15  1   1   1   20  1   1   1   1   1
16  1   2   1   22  0   0   0   0   1
17  1   1   1   25  0   0   0   0   0
18  1   2   2   47  0   0   1   1   1
19  1   1   2   31  0   0   0   0   0
20  1   2   1   20  1   1   0   1   0
21  1   2   1   26  0   1   0   1   0
22  1   2   1   46  1   1   1   1   1
23  1   2   1   32  1   1   1   1   1
24  1   2   1   48  0   1   0   0   0
25  1   1   2   35  0   0   0   0   0
26  1   2   1   26  0   0   0   0   0
27  1   1   1   23  1   1   0   1   1
28  1   1   2   36  0   1   1   0   0
29  1   1   1   19  0   1   1   0   0
30  1   2   1   28  0   0   0   0   0
31  1   1   1   37  0   0   0   0   0
32  1   2   1   23  0   1   1   1   1
33  1   2   1   30  1   1   1   1   0
34  1   1   1   15  0   0   1   1   0
35  1   2   1   26  0   0   0   1   0
36  1   1   2   45  0   0   0   0   0
37  1   2   1   31  0   0   1   0   0
38  1   2   1   50  0   0   0   0   0
39  1   1   1   28  0   0   0   0   0
40  1   1   1   26  0   0   0   0   0
41  1   1   1   14  0   0   0   0   1
42  1   2   1   31  0   0   1   0   0
43  1   1   1   13  1   1   1   1   1
44  1   1   1   27  0   0   0   0   0
45  1   1   1   26  0   1   0   1   1
46  1   1   1   49  0   0   0   0   0
47  1   1   1   63  0   0   0   0   0
48  1   2   1   57  1   1   1   1   1
49  1   1   1   27  1   1   1   1   1
50  1   2   1   22  0   0   1   1   1
51  1   2   1   15  0   0   1   1   1
52  1   1   1   43  0   0   0   1   0
53  1   2   2   32  0   0   0   1   0
54  1   2   1   11  1   1   1   1   0
55  1   1   1   24  1   1   1   1   1
56  1   2   1   25  0   1   1   0   1
57  2   1   2   39  0   0   0   0   0
58  2   2   1   25  0   0   1   1   1
59  2   2   1   58  1   1   1   1   1
60  2   1   2   51  1   1   0   1   1
61  2   1   2   32  1   0   0   1   1
62  2   1   1   45  1   1   0   0   0
63  2   1   2   44  1   1   1   1   1
64  2   1   2   48  0   0   0   0   0
65  2   2   1   26  0   1   1   1   1
66  2   2   1   14  0   1   1   1   1
67  2   1   2   48  0   0   0   0   0
68  2   2   1   13  1   1   1   1   1
69  2   1   1   20  0   1   1   1   1
70  2   2   1   37  1   1   0   0   1
71  2   2   1   25  1   1   1   1   1
72  2   2   1   20  0   0   0   0   0
73  2   1   2   58  0   1   0   0   0
74  2   1   1   38  1   1   0   0   0
75  2   2   1   55  1   1   1   1   1
76  2   2   1   24  1   1   1   1   1
77  2   1   2   36  1   1   0   0   1
78  2   1   1   36  0   1   1   1   1
79  2   2   2   60  1   1   1   1   1
80  2   1   1   15  1   0   0   1   1
81  2   2   1   25  1   1   1   1   0
82  2   2   1   35  1   1   1   1   1
83  2   2   1   19  1   1   0   1   1
84  2   1   2   31  1   1   1   1   1
85  2   2   1   21  1   1   1   1   1
86  2   2   2   37  0   1   1   1   1
87  2   1   1   52  0   1   1   1   1
88  2   2   1   55  0   0   1   1   0
89  2   1   1   19  1   0   0   1   1
90  2   1   1   20  1   0   1   1   1
91  2   1   1   42  1   0   0   0   0
92  2   2   1   41  1   1   1   1   1
93  2   2   1   52  0   0   0   0   0
94  2   1   2   47  0   1   1   0   1
95  2   1   1   11  1   1   1   1   1
96  2   1   1   14  0   0   0   1   0
97  2   1   1   15  1   1   1   1   1
98  2   1   1   66  1   1   1   1   1
99  2   2   1   34  0   1   1   0   1
100 2   1   1   43  0   0   0   0   0
101 2   1   1   33  1   1   1   0   1
102 2   1   1   48  1   1   0   0   0
103 2   2   1   20  0   1   1   1   1
104 2   1   2   39  1   0   1   0   0
105 2   2   1   28  0   1   0   0   0
106 2   1   2   38  0   0   0   0   0
107 2   2   1   43  1   1   1   1   1
108 2   2   2   39  0   1   1   1   1
109 2   2   1   68  0   1   1   1   1
110 2   2   2   63  1   1   1   1   1
111 2   2   1   31  1   1   1   1   1
;

proc ttest data=resptrial;
  class treat;
  var mnstatus arcsin arcroot;
run;

proc glm data=resptrial;
  class centre treat sex;
  model arcroot=centre age sex bl treat;
run;
  
proc logistic data=resptrial;
  class centre treat sex /param=ref ref=first;
  model ngood/visits=centre age sex bl treat /scale=d ;
run;

